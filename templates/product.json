{"sections":{"main":{"type":"main-product","blocks":{"vendor":{"type":"text","settings":{"text":"{{ product.vendor }}","text_style":"uppercase"}},"title":{"type":"title","settings":{}},"price":{"type":"price","settings":{}},"variant_picker":{"type":"variant_picker","settings":{"picker_type":"button","swatch_shape":"circle"}},"quantity_selector":{"type":"quantity_selector","settings":{}},"custom_liquid_BM8aKf":{"type":"custom_liquid","settings":{"custom_liquid":"<form id=\"cod-order-form\" style=\"max-width: 450px; margin: auto;\" novalidate>\n  <style>\n    .cod-label {\n      font-weight: 500;\n      display: block;\n      margin-bottom: 0.3rem;\n    }\n    .cod-label .required-star {\n      color: red;\n      margin-left: 3px;\n    }\n    .cod-input {\n      width: 100%;\n      padding: 1rem;\n      margin-bottom: 0.3rem;\n      border: 2px solid #ccc;\n      border-radius: 6px;\n    }\n    .error-message {\n      color: red;\n      font-size: 0.85rem;\n      margin-bottom: 0.75rem;\n      display: none;\n    }\n    .cod-submit {\n      width: 100%;\n      padding: 15px;\n      font-size: 1.5rem;\n      letter-spacing: .1rem;\n      background: #EDD76F;\n      color: white;\n      border: none;\n      border-radius: 6px;\n      cursor: pointer;\n      position: relative;\n      margin-top: 8px;\n    }\n    .cod-submit.loading {\n      opacity: 0.6;\n      cursor: not-allowed;\n    }\n    .cod-submit.loading::after {\n      content: '‚è≥';\n      position: absolute;\n      right: 15px;\n      top: 50%;\n      transform: translateY(-50%);\n    }\n    .cod-success {\n      display: none;\n      margin-top: 1rem;\n      color: green;\n      font-weight: bold;\n    }\n    #total-price {\n      font-size: 18px;\n      font-weight: bold;\n      margin-bottom: 1rem;\n    }\n  <\/style>\n\n  <div id=\"total-price\">Total: ...<\/div>\n\n  <label class=\"cod-label\" for=\"name\">Nom et Pr√©nom<span class=\"required-star\">*<\/span><\/label>\n  <input type=\"text\" id=\"name\" class=\"cod-input\" placeholder=\"√©cris ton nom complet\">\n  <div class=\"error-message\" id=\"name-error\">Ce champ est requis<\/div>\n\n  <label class=\"cod-label\" for=\"phone\">T√©l√©phone<span class=\"required-star\">*<\/span><\/label>\n  <input type=\"tel\" id=\"phone\" class=\"cod-input\" placeholder=\"√©cris ton num√©ro de t√©l√©phone\">\n  <div class=\"error-message\" id=\"phone-error\">Le num√©ro doit contenir uniquement des chiffres (pas de +, -, etc.)<\/div>\n\n  <label class=\"cod-label\" for=\"city\">Ville<span class=\"required-star\">*<\/span><\/label>\n  <input type=\"text\" id=\"city\" class=\"cod-input\" placeholder=\"√©cris ta ville\">\n  <div class=\"error-message\" id=\"city-error\">Ce champ est requis<\/div>\n\n  <label class=\"cod-label\" for=\"email\">E-mail<span class=\"required-star\">*<\/span><\/label>\n  <input type=\"email\" id=\"email\" class=\"cod-input\" placeholder=\"√©cris ton email\">\n  <div class=\"error-message\" id=\"email-error\">Ce champ est requis<\/div>\n\n  <button type=\"submit\" class=\"cod-submit\" id=\"submit-button\">Acheter maintenant<\/button>\n  <div id=\"cod-success\" class=\"cod-success\">‚úÖ Votre commande a √©t√© envoy√©e !<\/div>\n<\/form>\n\n<script>\n  const form = document.getElementById('cod-order-form');\n  const success = document.getElementById('cod-success');\n  const submitButton = document.getElementById('submit-button');\n  const totalPriceEl = document.getElementById('total-price');\n\n  const getPrice = () => {\n    const priceText = document.querySelector('.price__sale .price-item--sale, .price__regular .price-item--regular')?.innerText.trim();\n    const priceValue = priceText?.replace(\/[^\\d.]\/g, '');\n    return parseFloat(priceValue || '0');\n  };\n\n  const updateTotal = () => {\n    const quantity = parseInt(document.querySelector('input[name=\"quantity\"]')?.value || '1');\n    const unitPrice = getPrice();\n    const total = unitPrice * quantity;\n    totalPriceEl.textContent = `Total: ${total.toFixed(2)} MAD`;\n  };\n\n  document.querySelector('input[name=\"quantity\"]')?.addEventListener('input', updateTotal);\n  updateTotal(); \/\/ initial\n\n  function showError(id, show) {\n    const errorEl = document.getElementById(id + '-error');\n    if (errorEl) errorEl.style.display = show ? 'block' : 'none';\n  }\n\n  function validateFields(fields) {\n    let isValid = true;\n    fields.forEach(id => {\n      const value = document.getElementById(id).value.trim();\n      if (!value) {\n        showError(id, true);\n        isValid = false;\n      } else if (id === 'phone' && !\/^\\d{8,15}$\/.test(value)) {\n        showError(id, true);\n        isValid = false;\n      } else {\n        showError(id, false);\n      }\n    });\n    return isValid;\n  }\n\n  form.addEventListener('submit', async function (e) {\n    e.preventDefault();\n\n    const requiredFields = ['name', 'phone', 'city', 'email'];\n    if (!validateFields(requiredFields)) return;\n\n    submitButton.classList.add('loading');\n    submitButton.disabled = true;\n\n    const name = document.getElementById('name').value.trim();\n    const phone = document.getElementById('phone').value.trim();\n    const city = document.getElementById('city').value.trim();\n    const email = document.getElementById('email').value.trim();\n\n    const quantity = parseInt(document.querySelector('input[name=\"quantity\"]')?.value || '1');\n    const unitPrice = getPrice();\n    const total = unitPrice * quantity;\n    const productTitle = document.querySelector('a.product__title h2.h1')?.innerText.trim() || \"Produit inconnu\";\n    const productURL = window.location.href;\n    const orderNumber = \"COD-\" + Date.now();\n\n    const selectedVariantEl = document.querySelector('variant-selects legend span[data-selected-value]');\n    const variantLabel = selectedVariantEl?.parentNode?.childNodes[0]?.textContent?.trim().replace(':', '');\n    const variantValue = selectedVariantEl?.textContent?.trim();\n    const variant = variantLabel && variantValue ? `${variantLabel}: ${variantValue}` : \"Aucune\";\n\n    const message =\n      `üõí Nouvelle commande:\\n` +\n      `Commande: ${orderNumber}\\n` +\n      `Produit: ${productTitle}\\n` +\n      `Variante: ${variant}\\n` +\n      `Quantit√©: ${quantity}\\n` +\n      `Total: ${total.toFixed(2)} MAD\\n` +\n      `Lien: ${productURL}\\n` +\n      `Nom: ${name}\\n` +\n      `T√©l√©phone: ${phone}\\n` +\n      `Ville: ${city}\\n` +\n      `Email: ${email}`;\n\n    \/\/ Google Sheets Logging\n    const sheetURL = \"https:\/\/script.google.com\/macros\/s\/AKfycbx2YWPpraYVpQAsJmflaXjmtm07cy8T788i2m4yFO2mrLlKLIC1u6dHjCRxa7TJszFz\/exec\";\n    fetch(sheetURL, {\n      method: 'POST',\n      mode: 'no-cors',\n      headers: { 'Content-Type': 'application\/json' },\n      body: JSON.stringify({\n        orderNumber,\n        productTitle,\n        variant,\n        quantity,\n        total: `${total.toFixed(2)} MAD`,\n        productURL,\n        name,\n        phone,\n        city,\n        email\n      })\n    });\n\n    \/\/ WhatsApp Redirect\n    const whatsappNumber = \"212642130727\";\n    const whatsappURL = `https:\/\/wa.me\/${whatsappNumber}?text=${encodeURIComponent(message)}`;\n    window.open(whatsappURL, '_blank');\n\n    success.style.display = \"block\";\n    form.reset();\n    updateTotal();\n    submitButton.classList.remove('loading');\n    submitButton.disabled = false;\n  });\n<\/script>"}},"buy_buttons":{"type":"buy_buttons","disabled":true,"repeater":"{{ product.metafields.shopify[\"color-pattern\"].value }}","settings":{"show_dynamic_checkout":true,"show_gift_card_recipient":true}},"description":{"type":"description","settings":{}},"share":{"type":"share","settings":{"share_label":"Share"}}},"block_order":["vendor","title","price","variant_picker","quantity_selector","custom_liquid_BM8aKf","buy_buttons","description","share"],"custom_css":[],"settings":{"enable_sticky_info":true,"color_scheme":"scheme-165b7988-d61c-4f08-bc92-68695a4bb340","media_size":"medium","constrain_to_viewport":true,"media_fit":"contain","gallery_layout":"stacked","mobile_thumbnails":"hide","media_position":"left","image_zoom":"lightbox","hide_variants":false,"enable_video_looping":false,"padding_top":24,"padding_bottom":24}},"1746523682fcf2a247":{"type":"apps","disabled":true,"settings":{"include_margins":true}},"related-products":{"type":"related-products","settings":{"heading":"You may also like","heading_size":"h2","products_to_show":4,"columns_desktop":4,"columns_mobile":"2","color_scheme":"scheme-165b7988-d61c-4f08-bc92-68695a4bb340","image_ratio":"adapt","image_shape":"default","show_secondary_image":false,"show_vendor":false,"show_rating":false,"padding_top":36,"padding_bottom":68}},"1746785372ac1b5ea7":{"type":"apps","disabled":true,"settings":{"include_margins":true}},"1746785287fc012f46":{"type":"apps","disabled":true,"settings":{"include_margins":true}}},"order":["main","1746523682fcf2a247","related-products","1746785372ac1b5ea7","1746785287fc012f46"]}